from src.Directory import Directory
import os


"""
Remove any Javascript scripts from the scraped HTML files.
"""

baseDirectory = "/home/nsifniotis/PycharmProjects/zionshopusn6nopy.onion/scrapedData"
dirsToClean = [ 'help', 'category', 'forum', 'forum/post', 'item', 'vendor']

for dirToClean in dirsToClean:
    fullPath = os.path.normpath(baseDirectory + "/" + dirToClean)
    directory = Directory(fullPath)

    directory.Scan()
    print("Cleaning files in " + fullPath)

    for file in directory.FileNames():
        if '.' not in file:
            # It's a HTML file with no extension, because wget is weird that way.
            file = os.path.normpath(baseDirectory + "/" + dirToClean + "/" + file)
            print("   Cleaning" + file)

            with open(file, encoding = "ISO-8859-1") as inputFile:
                lines = inputFile.readlines()

            newLines = []
            for line in lines:
                if '</script>' in line:
                    line = line.replace('</script>', '</script> -->')

                if '<script>' in line:
                    line = line.replace('<script>', '<!-- <script>')

                newLines.append(line)

            with open(file, "w", encoding = "ISO-8859-1") as outputFile:
                outputFile.writelines(newLines)
